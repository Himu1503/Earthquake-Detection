getwd()
list.files()
Earthquake <- read.csv("Earthquake_Data_cleaned_01 (1).csv")
print(head(Earthquake))
Earthquake$mag <- ifelse(test=Earthquake$mag<5, yes='Minor', no='Major')
Earthquake$mag <- as.factor(Earthquake$mag)
Earthquake$latitude <- as.factor(Earthquake$latitude)
Earthquake$longitude <- as.factor(Earthquake$longitude)
source("C:/Users/Himu BaBa/Desktop/PBAProject/Logistic.R")
library(dplyr)
IC<-c('India','China','Pakistan','Indonesia')
Earthquake %>% filter(Earthquake$country %in% IC)->IC_Earth
View(Earthquake)
View(IC_Earth)
str(IC_Earth)
IC_Earth$mag <- ifelse(test=IC_Earth$mag<5, yes='Minor', no='Major')
IC_Earth$mag <- as.factor(IC_Earth$mag)
IC_Earth$latitude <- as.factor(IC_Earth$latitude)
IC_Earth$longitude <- as.factor(IC_Earth$longitude)
IC_Earth$country <- as.factor(IC_Earth$country)
IC_Earth$depth <- as.factor(IC_Earth$depth)
IC_Earth$gap <- as.factor(IC_Earth$gap)
IC_Earth$dmin <- as.factor(IC_Earth$dmin)
IC_Earth$rms <- as.factor(IC_Earth$rms)
IC_Earth$horizontal_error <- as.factor(IC_Earth$horizontal_error)
IC_Earth$depth_error <- as.factor(IC_Earth$depth_error)
IC_Earth$mag_error <- as.factor(IC_Earth$mag_error)
IC_Earth$mag_nst <- as.factor(IC_Earth$mag_nst)
str(IC_Earth)
xtabs(~ mag +country, data=IC_Earth)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
summary(logistic)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
summary(logistic)
source("C:/Users/Himu BaBa/Desktop/PBAProject/Logistic.R")
str(IC_Earth)
xtabs(~ mag +country, data=IC_Earth)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
summary(logistic)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
summary(logistic)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
summary(logistic)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
ll.null <- logistic$null.deviance/-2
ll.proposed <- logistic$deviance/-2
(ll.null-ll.proposed)/ll.null
Earthquake$mag <- ifelse(test=Earthquake$mag<5, yes='Minor', no='Major')
Earthquake$mag <- as.factor(Earthquake$mag)
Earthquake$latitude <- as.factor(Earthquake$latitude)
Earthquake$longitude <- as.factor(Earthquake$longitude)
#library(dplyr) for selecting pipe filter
library(dplyr)
IC<-c('India','China','Pakistan','Indonesia')
Earthquake %>% filter(Earthquake$country %in% IC)->IC_Earth
View(Earthquake)
View(IC_Earth)
str(IC_Earth)
IC_Earth$mag <- ifelse(test=IC_Earth$mag<5, yes='Minor', no='Major')
IC_Earth$mag <- as.factor(IC_Earth$mag)
IC_Earth$latitude <- as.factor(IC_Earth$latitude)
IC_Earth$longitude <- as.factor(IC_Earth$longitude)
IC_Earth$country <- as.factor(IC_Earth$country)
IC_Earth$depth <- as.factor(IC_Earth$depth)
IC_Earth$gap <- as.factor(IC_Earth$gap)
IC_Earth$dmin <- as.factor(IC_Earth$dmin)
IC_Earth$rms <- as.factor(IC_Earth$rms)
IC_Earth$horizontal_error <- as.factor(IC_Earth$horizontal_error)
IC_Earth$depth_error <- as.factor(IC_Earth$depth_error)
IC_Earth$mag_error <- as.factor(IC_Earth$mag_error)
IC_Earth$mag_nst <- as.factor(IC_Earth$mag_nst)
str(IC_Earth)
xtabs(~ mag +country, data=IC_Earth)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
IC_Earth$latitude <- as.factor(IC_Earth$latitude)
IC_Earth$longitude <- as.factor(IC_Earth$longitude)
IC_Earth$country <- as.factor(IC_Earth$country)
IC_Earth$depth <- as.factor(IC_Earth$depth)
IC_Earth$gap <- as.factor(IC_Earth$gap)
IC_Earth$dmin <- as.factor(IC_Earth$dmin)
IC_Earth$rms <- as.factor(IC_Earth$rms)
IC_Earth$horizontal_error <- as.factor(IC_Earth$horizontal_error)
IC_Earth$depth_error <- as.factor(IC_Earth$depth_error)
IC_Earth$mag_error <- as.factor(IC_Earth$mag_error)
IC_Earth$mag_nst <- as.factor(IC_Earth$mag_nst)
str(IC_Earth)
logistic <- glm(mag ~ country, data=IC_Earth, family ="binomial")
Earthquake %>% filter(Earthquake$country %in% IC)->IC_Earth
View(Earthquake)
View(IC_Earth)
str(IC_Earth)
IC_Earth$mag <- ifelse(test=IC_Earth$mag<5, yes='Minor', no='Major')
IC_Earth$mag <- ifelse(test=IC_Earth$mag<=5, yes='Minor', no='Major')
IC_Earth$mag <- as.factor(IC_Earth$mag)
IC_Earth$latitude <- as.factor(IC_Earth$latitude)
IC_Earth$longitude <- as.factor(IC_Earth$longitude)
IC_Earth$country <- as.factor(IC_Earth$country)
IC_Earth$depth <- as.factor(IC_Earth$depth)
IC_Earth$gap <- as.factor(IC_Earth$gap)
IC_Earth$dmin <- as.factor(IC_Earth$dmin)
IC_Earth$rms <- as.factor(IC_Earth$rms)
IC_Earth$horizontal_error <- as.factor(IC_Earth$horizontal_error)
IC_Earth$depth_error <- as.factor(IC_Earth$depth_error)
IC_Earth$mag_error <- as.factor(IC_Earth$mag_error)
IC_Earth$mag_nst <- as.factor(IC_Earth$mag_nst)
str(IC_Earth)
view(IC_Earth)
View(IC_Earth)
country1<-c('China','Pakistan')
IC_Earth %>% filter(IC_Earth$country %in%  country1) ->IC_Earth1
View(IC_Earth1)
source("C:/Users/Himu BaBa/Desktop/PBAProject/Logistic.R")
source("C:/Users/Himu BaBa/Desktop/PBAProject/Logistic.R")
IC_Earth %>% filter(IC_Earth$country %in%  country1) ->IC_Earth1
View(IC_Earth1)
str(IC_Earth)
View(IC_Earth)
country1<-c('China','Pakistan')
IC_Earth %>% filter(IC_Earth$country %in%  country1) ->IC_Earth1
View(IC_Earth1)
IC_Earth %>% filter(IC_Earth$country %in%  country1) ->IC_Earth1
View(IC_Earth1)
IC_Earth %>% filter(IC_Earth$country %in%  country1) ->IC_Earth1
IC_Earth %>% filter(IC_Earth$country %in%  country1) ->IC_Earth1
Earthquake <- read.csv("Earthquake_Data_cleaned_01 (1).csv")
Earthquake$mag <- ifelse(test=Earthquake$mag<5, yes='Minor', no='Major')
Earthquake$mag <- as.factor(Earthquake$mag)
library(dplyr)
IC<-c('India','China','Pakistan','Indonesia')
Earthquake %>% filter(Earthquake$country %in% IC)->IC_Earth
View(Earthquake)
View(IC_Earth)
str(IC_Earth)
IC_Earth$mag <- ifelse(test=IC_Earth$mag<=5, yes='Minor', no='Major')
IC_Earth$mag <- ifelse(test=IC_Earth$mag<5, yes='Minor', no='Major')
IC_Earth$mag <- as.factor(IC_Earth$mag)
IC_Earth$latitude <- as.factor(IC_Earth$latitude)
IC_Earth$longitude <- as.factor(IC_Earth$longitude)
IC_Earth$country <- as.factor(IC_Earth$country)
IC_Earth$depth <- as.factor(IC_Earth$depth)
IC_Earth$gap <- as.factor(IC_Earth$gap)
IC_Earth$dmin <- as.factor(IC_Earth$dmin)
IC_Earth$rms <- as.factor(IC_Earth$rms)
IC_Earth$horizontal_error <- as.factor(IC_Earth$horizontal_error)
IC_Earth$depth_error <- as.factor(IC_Earth$depth_error)
IC_Earth$mag_error <- as.factor(IC_Earth$mag_error)
IC_Earth$mag_nst <- as.factor(IC_Earth$mag_nst)
str(IC_Earth)
View(IC_Earth)
country1<-c('China','Pakistan')
IC_Earth %>% filter(IC_Earth$country %in%  country1) ->IC_Earth1
View(IC_Earth1)
IC_Earth1$mag<- ifelse(test=IC_Earth1$mag<5 , yes= '1', no='0')
IC_Earth1$mag<- as.factor(IC_Earth1)
xtabs(~ mag +country, data=IC_Earth1)
xtabs(~depth+ country ,data= IC_Earth1 )
logistic <- glm(depth ~ country, data=IC_Earth1, family ="binomial")
summary(logistic)
logistic <- glm(mag ~ country, data=IC_Earth1, family ="binomial")
logistic <- glm(depth~ country, data=IC_Earth1, family ="binomial")
summary(logistic)
ll.null <- logistic$null.deviance/-2
ll.proposed <- logistic$deviance/-2
(ll.null-ll.proposed)/ll.null
predicted.data <- data.frame(
probability.of.depth=logistic$fitted.values,
country=IC_Earth1$country)
predicted.data<- predicted.data[
order(predicted.data$probability.of.depth, decreasing=FALSE),]
predicted.data$rank <- 1:nrow(predicted.data)
ggplot(data=predicted.data, aes(x=probability.of.depth, y=country)) +
geom_point(aes(color=country), size=5) +
xlab("depth") +
ylab("country")
library(ggplot2)
ggplot(data=predicted.data, aes(x=probability.of.depth, y=country)) +
geom_point(aes(color=country), size=5) +
xlab("depth") +
ylab("country")
logistic <- glm(country~ . , data=IC_Earth1, family ="binomial")
source("C:/Users/Himu BaBa/Desktop/PBAProject/Logistic.R")
getwd()
list.files()
Earthquake <- read.csv("Earthquake_Data_cleaned_01 (1).csv")
print(head(Earthquake))
str(Earthquake)
Earthquake$mag <- ifelse(test=Earthquake$mag<5, yes='Minor', no='Major')
IC_Earth$mag <- as.factor(IC_Earth$mag)
View(IC_Earth$mag)
IC_Earth$latitude <- as.factor(IC_Earth$latitude)
IC_Earth$longitude <- as.factor(IC_Earth$longitude)
IC_Earth$country <- as.factor(IC_Earth$country)
IC_Earth$depth <- as.factor(IC_Earth$depth)
IC_Earth$gap <- as.factor(IC_Earth$gap)
IC_Earth$dmin <- as.factor(IC_Earth$dmin)
IC_Earth$rms <- as.factor(IC_Earth$rms)
IC_Earth$horizontal_error <- as.factor(IC_Earth$horizontal_error)
IC_Earth$depth_error <- as.factor(IC_Earth$depth_error)
IC_Earth$mag_error <- as.factor(IC_Earth$mag_error)
IC_Earth$mag_nst <- as.factor(IC_Earth$mag_nst)
str(IC_Earth)
Earthquake<- na.omit(Earthquake)
View(IC_Earth)
IC_Earth<- na.omit(IC_Earth)
View(IC_Earth)
str(IC_Earth)
getwd()
list.files()
Earthquake <- read.csv("Earthquake_Data_cleaned_01 (1).csv")
print(head(Earthquake))
str(Earthquake)
Earthquake$mag <- ifelse(test=Earthquake$mag<5, yes='Minor', no='Major')
Earthquake$mag <- as.factor(Earthquake$mag)
library(dplyr)
IC<-c('India','China','Pakistan','Indonesia')
Earthquake %>% filter(Earthquake$country %in% IC)->IC_Earth
View(Earthquake)
View(IC_Earth)
str(IC_Earth)
IC_Earth$mag <- ifelse(test=IC_Earth$mag<5, yes='Minor', no='Major')
IC_Earth$mag <- as.factor(IC_Earth$mag)
IC_Earth$mag_type <- NULL
IC_Earth$time <- NULL
IC_Earth$net <- NULL
IC_Earth$nst <- NULL
IC_Earth$id <- NULL
IC_Earth$updated <- NULL
IC_Earth$place <- NULL
IC_Earth$type <- NULL
IC_Earth$status <- NULL
IC_Earth$mag_source <- NULL
str(IC_Earth)
View(IC_Earth)
IC_Earth$mag <- ifelse(test=IC_Earth$mag<5, yes='Minor', no='Major')
IC_Earth$mag <- as.factor(IC_Earth$mag)
str(IC_Earth)
View(IC_Earth)
library(dplyr)
IC<-c('India','China','Pakistan','Indonesia')
Earthquake %>% filter(Earthquake$country %in% IC)->IC_Earth
View(Earthquake)
View(IC_Earth)
xtabs(~ mag +country, data=IC_Earth)
logistic <- glm(mag~ country, data=IC_Earth, family ="binomial")
summary(logistic)
logistic <- glm(mag ~ . , data = IC_Earth , family="binomial")
ll.null <- logistic$null.deviance/-2
ll.proposed <- logistic$deviance/-2
(ll.null-ll.proposed)/ll.null
1 - pchisq(2*(ll.proposed - ll.null), df=(length(logistic$coefficients)-1))
predicted.data <- data.frame(
probability.of.mag=logistic$fitted.values,
country=IC_Earth$country)
predicted.data<- predicted.data[
order(predicted.data$probability.of.mag, decreasing=FALSE),]
predicted.data$rank <- 1:nrow(predicted.data)
library(ggplot2)
ggplot(data=predicted.data, aes(x=probability.of.mag, y=country)) +
geom_point(aes(color=country), size=5) +
xlab("mag") +
ylab("country")
library(ggplot2)
library(cowplot)
install.packages(cowplot)
install.packages("cowplot")
library(cowplot)
ggplot(data=predicted.data, aes(x=probability.of.mag, y=country)) +
geom_point(aes(color=country), size=5) +
xlab("mag") +
ylab("country")
